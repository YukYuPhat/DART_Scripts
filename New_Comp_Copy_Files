#this is for Maintenance Surface Pro Tablets

#create Temp folder and copy script into folder

Function Copy-Files{
    param ($ToCopy, $Recur, $MSIFile, $CopyPath, $ExePath, $TempPath)
    $Stuff = read-host “Type yes to copy $ToCopy...”

    if ($Stuff -eq 'yes'){

        #copy  I:\Maintenance\Allison Software to temp folder
        if ($Recur -eq 'yes'){
        
        Copy-Item -Path $CopyPath -Destination $TempPath -Recurse |out-null
        }else{
        Copy-Item -Path $CopyPath -Destination $TempPath |out-null
        }

#    if ($MSIFile -eq 'no'){
#        Start-Process $ExePath |out-null
#     }
#    if ($MSIFile -eq 'yes'){
#        msiexec.exe /i  |out-null}
    }


   




}

#copy script to new computer from I: drive

#Copy cisco umbrella and dart installers to temp

$NewComputer = read-host "Type yes to install onto a new computer."

if ($NewComputer -eq 'yes'){

    Copy-Item -Path I:\Cisco\AnyConnect\anyconnect-win-4.7.00136-predeploy-k9\anyconnect-win-4.7.00136-umbrella-predeploy-k9.msi -Destination C:\Temp\ |out-null

    Copy-Item -Path I:\Cisco\AnyConnect\anyconnect-win-4.7.00136-predeploy-k9\anyconnect-win-4.7.00136-dart-predeploy-k9.msi -Destination C:\Temp\ |out-null

    msiexec.exe /i anyconnect-win-4.7.00136-umbrella-predeploy-k9.msi |out-null
    read-host “Press ENTER to install Dart Cisco files...”

    msiexec.exe /i anyconnect-win-4.7.00136-dart-predeploy-k9.msi |out-null

    echo 'cisco done'
}

#variables for paths and files to run

$TempPath = "C:\Temp\"

$AllisonQuestion = "Allison Transmission Application"
$AllisonPath = "I:\Maintenance\Allison\AllisonDOCv2019.1.exe"
$AllisonExecute = "C:\Temp\AllisonDOCv2019.1.exe"
$AllisonRecurse = "no"
$AllisonMSI = "no"

Copy-Files $AllisonQuestion $AllisonRecurse $AllisonMSI $AllisonPath $AllisonExecute $TempPath

$VoithQuestion= "Voith Software"
$VoithPath = "I:\Maintenance\Voith\Voith.3\DIWAgnosis352Setup.exe"
$VoithExecute = "C:\Temp\DIWAgnosis352Setup.exe"
$VoithRecurse = 'no'
$VoithMSI = 'no'

Copy-Files $VoithQuestion $VoithRecurse $VoithMSI $VoithPath $VoithExecute $TempPath

$CumminsQuestion = "Cummins Insite Application"
$CumminsPath = "I:\Maintenance\Cummins\insite8_06_0_0104\INSITE\"
$CumminsExecute = "C:\Temp\INSITE\INSITE.msi"
$CumminsRecurse = 'yes'
$CumminsMSI = 'yes'

Copy-Files $CumminsQuestion $CumminsRecurse $CumminsMSI $CumminsPath $CumminsExecute $TempPath

$WabcoQuestion = "Wabco Meritor Application"
$WabcoPath = "I:\Maintenance\Wabco\"
$WabcoExecute = "C:\Temp\Wabco\setup.exe"
$WabcoRecurse = 'yes'
$WabcoMSI = 'no'

Copy-Files $WabcoQuestion $WabcoRecurse $WabcoMSI $WabcoPath $WabcoExecute $TempPath

$VaporQuestion = "Vapor CLASS Diagnostic System Application"
$VaporPath = "I:\Maintenance\Vapor_CLASS_Systems\Customer_CLASS_Diag_3.35a\"
$VaporExecute = "C:\Temp\INSITE\INSITE.msi"
$VaporRecurse = 'yes'
$VaporMSI = 'yes'

Copy-Files $VaporQuestion $VaporRecurse $VaporMSI $VaporPath $VaporExecute $TempPath
echo "Must Copy the 'CLASS Diag144.exe' program into C:\Users\Public\Desktop folder to be used for all users!!!"

$a = read-host "press enter to exit"


